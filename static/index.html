<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Todo List ‚Äî Demo Site</title>

  <!-- Reduce noisy 404s from browser auto-requests -->
  <link rel="icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png" />

  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f1f5f9;
      min-height: 100vh;
      color: #1e293b;
    }

    header {
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: #fff;
      padding: 28px 0 24px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(99,102,241,.3);
    }
    header h1 { font-size: 28px; font-weight: 700; letter-spacing: -.5px; }
    header p  { margin-top: 4px; font-size: 14px; opacity: .8; }

    main {
      max-width: 560px;
      margin: 32px auto;
      padding: 0 16px 120px;
    }

    /* ‚îÄ‚îÄ Add form ‚îÄ‚îÄ */
    .add-form {
      display: flex; gap: 10px;
      background: #fff;
      border-radius: 12px;
      padding: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,.06);
      margin-bottom: 20px;
    }
    .add-form input {
      flex: 1;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 10px 14px;
      font-size: 14px;
      outline: none;
      transition: border-color .15s;
    }
    .add-form input:focus { border-color: #6366f1; }
    .add-form button {
      background: #6366f1;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: background .15s;
      white-space: nowrap;
    }
    .add-form button:hover { background: #4f46e5; }

    /* ‚îÄ‚îÄ Stats ‚îÄ‚îÄ */
    .stats {
      font-size: 12px;
      color: #64748b;
      margin-bottom: 12px;
      padding: 0 4px;
    }

    /* ‚îÄ‚îÄ Todo list ‚îÄ‚îÄ */
    .todo-list { display: flex; flex-direction: column; gap: 8px; }

    .todo-item {
      display: flex; align-items: center; gap: 12px;
      background: #fff;
      border-radius: 10px;
      padding: 14px 16px;
      box-shadow: 0 1px 4px rgba(0,0,0,.05);
      transition: box-shadow .15s, opacity .2s;
      animation: slide-in .2s ease;
    }
    @keyframes slide-in {
      from { opacity:0; transform:translateY(-6px); }
      to   { opacity:1; transform:translateY(0); }
    }
    .todo-item.done { opacity: .55; }
    .todo-item.done .todo-title { text-decoration: line-through; color: #94a3b8; }

    .todo-check {
      width: 20px; height: 20px; flex-shrink: 0;
      accent-color: #6366f1; cursor: pointer;
    }
    .todo-title { flex: 1; font-size: 15px; line-height: 1.4; }
    .todo-id { font-size: 11px; color: #cbd5e1; }
    .todo-delete {
      background: none; border: none;
      color: #cbd5e1; cursor: pointer;
      font-size: 18px; line-height: 1;
      padding: 2px 4px; border-radius: 4px;
      transition: color .15s;
    }
    .todo-delete:hover { color: #ef4444; }

    .empty-state {
      text-align: center;
      padding: 48px 0;
      color: #94a3b8;
    }
    .empty-state .icon { font-size: 40px; margin-bottom: 12px; }
    .empty-state p { font-size: 14px; }

    .error-banner {
      background: #fef2f2;
      border: 1px solid #fecaca;
      color: #b91c1c;
      border-radius: 8px;
      padding: 12px 16px;
      font-size: 13px;
      margin-bottom: 16px;
      display: none;
    }
  </style>
</head>
<body>

<header>
  <h1>üìù Todo List</h1>
  <p>Demo Site ‚Äî powered by Balanco Agent</p>
</header>

<main>
  <div class="add-form">
    <input id="new-todo" type="text" placeholder="What needs to be done?" />
    <button onclick="addTodo()">Add</button>
  </div>

  <div class="error-banner" id="error-banner"></div>
  <div class="stats" id="stats"></div>
  <div class="todo-list" id="todo-list"></div>
</main>

<script>
  const API = '';  // same origin

  async function loadTodos() {
    try {
      const res = await fetch(`${API}/todos`);
      const todos = await res.json();
      render(todos);
    } catch (e) {
      showError('Could not load todos: ' + e.message);
    }
  }

  async function addTodo() {
    const input = document.getElementById('new-todo');
    const title = input.value.trim();
    if (!title) return;
    try {
      await fetch(`${API}/todos`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title }),
      });
      input.value = '';
      loadTodos();
    } catch (e) { showError(e.message); }
  }

  async function toggleTodo(id, done) {
    try {
      await fetch(`${API}/todos/${id}`, {
        method: 'PATCH',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ done }),
      });
      loadTodos();
    } catch (e) { showError(e.message); }
  }

  async function deleteTodo(id) {
    try {
      await fetch(`${API}/todos/${id}`, { method: 'DELETE' });
      loadTodos();
    } catch (e) { showError(e.message); }
  }

  function render(todos) {
    const list = document.getElementById('todo-list');
    const stats = document.getElementById('stats');
    const done = todos.filter(t => t.done).length;
    stats.textContent = todos.length
      ? `${todos.length} item${todos.length !== 1 ? 's' : ''} ¬∑ ${done} completed`
      : '';

    if (!todos.length) {
      list.innerHTML = `
        <div class="empty-state">
          <div class="icon">‚úÖ</div>
          <p>Nothing here yet. Add a todo above!</p>
        </div>`;
      return;
    }

    list.innerHTML = todos.map(t => `
      <div class="todo-item ${t.done ? 'done' : ''}">
        <input class="todo-check" type="checkbox" ${t.done ? 'checked' : ''}
               onchange="toggleTodo(${t.id}, this.checked)" />
        <span class="todo-title">${escHtml(t.title)}</span>
        <span class="todo-id">#${t.id}</span>
        <button class="todo-delete" onclick="deleteTodo(${t.id})" title="Delete">√ó</button>
      </div>`
    ).join('');
  }

  function showError(msg) {
    const el = document.getElementById('error-banner');
    el.textContent = msg;
    el.style.display = 'block';
    setTimeout(() => { el.style.display = 'none'; }, 5000);
  }

  function escHtml(str) {
    return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
  }

  document.getElementById('new-todo').addEventListener('keydown', e => {
    if (e.key === 'Enter') addTodo();
  });

  loadTodos();
</script>

<!--
  AI Dev Panel ‚Äî remove this block to disable.
  To use a different UI, remove this script and point your UI at http://localhost:8000.
-->
<script
  src="http://localhost:8000/static/dev-panel.js"
  data-agent="http://localhost:8000"
  data-repo="balanco-elias/demo-site"
  data-textarea-rows="14">
</script>

</body>
</html>
